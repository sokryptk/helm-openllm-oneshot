model:
  source: "huggingface"  # huggingface | local | s3 | gcs
  id: "mistralai/Mistral-7B-Instruct-v0.2"
  backend: "vllm"  # vllm | pt | ggml
  quantization: null  # int8 | int4 | gptq | awq
  maxModelLen: null
  trustRemoteCode: false

objectStorage:  # for s3/gcs sources
  endpoint: ""
  region: ""
  existingSecret: ""
  accessKey: ""
  secretKey: ""

localModel:  # for local source
  mountPath: "/models"
  existingClaim: ""

image:
  repository: ghcr.io/sokryptk/openllm-base
  tag: "0.2.0"
  pullPolicy: IfNotPresent

imagePullSecrets: []

replicaCount: 1

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 5
  targetCPUUtilizationPercentage: 70
  targetMemoryUtilizationPercentage: 80
  customMetrics: []
  behavior:
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
        - type: Percent
          value: 10
          periodSeconds: 60
    scaleUp:
      stabilizationWindowSeconds: 0
      policies:
        - type: Percent
          value: 100
          periodSeconds: 15
        - type: Pods
          value: 4
          periodSeconds: 15
      selectPolicy: Max

resources:
  requests:
    cpu: "2"
    memory: "8Gi"
  limits:
    cpu: "8"
    memory: "32Gi"

gpu:
  enabled: false
  type: ""  # nvidia-tesla-t4, nvidia-tesla-a100, etc
  count: 1
  memoryUtilization: 0.9

service:
  type: LoadBalancer
  port: 80
  targetPort: 3000
  nodePort: null
  loadBalancerIP: ""
  loadBalancerSourceRanges: []
  externalTrafficPolicy: Cluster
  sessionAffinity: None  # ClientIP for sticky sessions
  sessionAffinityTimeout: 10800
  annotations: {}

ingress:
  enabled: false
  className: ""
  annotations: {}
  hosts:
    - host: openllm.local
      paths:
        - path: /
          pathType: Prefix
  tls: []

huggingface:
  existingSecret: ""
  secretKey: "token"
  token: ""

persistence:
  enabled: false
  storageClass: ""
  accessMode: ReadWriteOnce
  size: 50Gi
  existingClaim: ""
  annotations: {}

podAnnotations: {}
podLabels: {}

podSecurityContext:
  fsGroup: 1000

securityContext:
  runAsUser: 1000
  runAsGroup: 1000
  runAsNonRoot: true

probes:
  liveness:
    enabled: true
    initialDelaySeconds: 120
    periodSeconds: 30
    timeoutSeconds: 10
    failureThreshold: 3
  readiness:
    enabled: true
    initialDelaySeconds: 60
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3
  startup:
    enabled: true
    initialDelaySeconds: 30
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 30

nodeSelector: {}
tolerations: []
affinity: {}
topologySpreadConstraints: []

podDisruptionBudget:
  enabled: false
  minAvailable: 1

extraEnv: []
extraEnvFrom: []

serviceAccount:
  create: true
  name: ""
  annotations: {}

server:
  workers: 1
  timeout: 300
  maxConcurrentRequests: null
  corsOrigins: "*"
